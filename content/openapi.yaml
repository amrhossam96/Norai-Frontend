openapi: 3.0.3
info:
  title: Oblien Domains API
  description: |
    # Introduction
    
    The Oblien Domains API allows you to programmatically interact with Oblien domains services, including checking domain availability, registering domains, managing DNS records, and having your own reseller program.
    
    ## Authentication
    
    All API requests require an API key to be sent in the `Authorization` header.
    
    ```
    Authorization: Bearer YOUR_API_KEY
    ```
    
    You can manage your API keys in the [Oblien Dashboard](https://dashboard.domains.oblien.com/api-keys).
  version: 1.0.0
  contact:
    name: Oblien Support
    url: https://support.oblien.com
    email: support@oblien.com
  license:
    name: APGLv3
    url: https://www.gnu.org/licenses/agpl-3.0.en.html
servers:
  - url: https://api.oblien.com/v1
    description: Production API
tags:
  - name: Domains
    description: Operations related to domain registration and management
  - name: DNS
    description: Operations related to DNS record management
  - name: Account
    description: Operations related to account management
paths:
  /domains/check:
    get:
      tags:
        - Domains
      summary: Check domain availability
      description: |
        Check if a domain is available for registration.
        
        This endpoint also returns pricing information, including whether the domain is a premium domain.
      operationId: checkDomainAvailability
      parameters:
        - name: domain
          in: query
          description: The domain name to check
          required: true
          schema:
            type: string
            example: example.com
      responses:
        '200':
          description: Domain availability information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DomainAvailability'
              example:
                domainName: example.com
                available: false
                premium: false
                price: null
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: INVALID_DOMAIN
                message: The provided domain name is invalid
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: UNAUTHORIZED
                message: API key is missing or invalid
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: INTERNAL_ERROR
                message: An unexpected error occurred
      x-codeSamples:
        - lang: curl
          source: |
            curl --request GET \
              --url 'https://api.oblien.com/v1/domains/check?domain=example.com' \
              --header 'Authorization: Bearer YOUR_API_KEY'
        - lang: Node.js
          source: |
            const axios = require('axios');
            
            const checkDomain = async (domainName) => {
              try {
                const response = await axios.get(`https://api.oblien.com/v1/domains/check?domain=${domainName}`, {
                  headers: {
                    'Authorization': 'Bearer YOUR_API_KEY'
                  }
                });
                return response.data;
              } catch (error) {
                console.error('Error checking domain:', error.response?.data || error.message);
                throw error;
              }
            };
            
            // Example usage
            checkDomain('example.com')
              .then(result => console.log(result))
              .catch(err => console.error(err));
        - lang: Python
          source: |
            import requests
            
            def check_domain(domain_name):
                url = f"https://api.oblien.com/v1/domains/check?domain={domain_name}"
                headers = {
                    "Authorization": "Bearer YOUR_API_KEY"
                }
                
                response = requests.get(url, headers=headers)
                response.raise_for_status()  # Raises an exception for 4XX/5XX responses
                
                return response.json()
            
            # Example usage
            result = check_domain("example.com")
            print(result)
        - lang: Ruby
          source: |
            require 'uri'
            require 'net/http'
            require 'json'
            
            def check_domain(domain_name)
              url = URI("https://api.oblien.com/v1/domains/check?domain=#{domain_name}")
              
              http = Net::HTTP.new(url.host, url.port)
              http.use_ssl = true
              
              request = Net::HTTP::Get.new(url)
              request["Authorization"] = "Bearer YOUR_API_KEY"
              
              response = http.request(request)
              
              JSON.parse(response.read_body)
            end
            
            # Example usage
            result = check_domain("example.com")
            puts result
  
  /domains/register:
    post:
      tags:
        - Domains
      summary: Register a domain
      description: |
        Register a new domain name.
        
        This endpoint allows you to register a domain name with the specified contact information and nameservers.
      operationId: registerDomain
      requestBody:
        description: Domain registration details
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DomainRegistration'
            example:
              domainName: example.com
              years: 1
              nameservers:
                - ns1.oblien.com
                - ns2.oblien.com
              contactInfo:
                firstName: John
                lastName: Doe
                email: john@example.com
                phoneNumber: "+1.5555555555"
                address:
                  street: "123 Main St"
                  city: "San Francisco"
                  state: "CA"
                  postalCode: "94105"
                  country: "US"
      responses:
        '201':
          description: Domain registered successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Domain'
              example:
                id: dom_12345
                domainName: example.com
                status: active
                expiresAt: "2024-03-16T00:00:00Z"
                autoRenew: true
                nameservers:
                  - ns1.oblien.com
                  - ns2.oblien.com
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: DOMAIN_NOT_AVAILABLE
                message: The domain example.com is not available for registration
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: UNAUTHORIZED
                message: API key is missing or invalid
        '402':
          description: Payment required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: INSUFFICIENT_FUNDS
                message: Your account has insufficient funds to complete this purchase
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: INTERNAL_ERROR
                message: An unexpected error occurred

components:
  schemas:
    DomainAvailability:
      type: object
      description: Domain availability check result
      required:
        - domainName
        - available
      properties:
        domainName:
          type: string
          description: The domain name that was checked
          example: example.com
        available:
          type: boolean
          description: Whether the domain is available for registration
          example: true
        premium:
          type: boolean
          description: Whether the domain is a premium domain
          example: false
        price:
          type: number
          format: float
          description: The price of the domain in USD (null if domain is not available)
          nullable: true
          example: 12.99
    
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: A machine-readable error code
          example: INVALID_DOMAIN
        message:
          type: string
          description: A human-readable error message
          example: The provided domain name is invalid
    
    DomainRegistration:
      type: object
      required:
        - domainName
        - years
        - contactInfo
      properties:
        domainName:
          type: string
          description: The domain name to register
          example: example.com
        years:
          type: integer
          minimum: 1
          maximum: 10
          description: Registration period in years
          example: 1
        nameservers:
          type: array
          items:
            type: string
          description: List of nameservers to use (optional, defaults to Oblien nameservers)
          example:
            - ns1.oblien.com
            - ns2.oblien.com
        contactInfo:
          $ref: '#/components/schemas/ContactInfo'
    
    ContactInfo:
      type: object
      required:
        - firstName
        - lastName
        - email
        - phoneNumber
        - address
      properties:
        firstName:
          type: string
          description: First name of the registrant
          example: John
        lastName:
          type: string
          description: Last name of the registrant
          example: Doe
        email:
          type: string
          format: email
          description: Email address of the registrant
          example: john@example.com
        phoneNumber:
          type: string
          description: Phone number of the registrant (in E.164 format)
          example: "+1.5555555555"
        address:
          $ref: '#/components/schemas/Address'
    
    Address:
      type: object
      required:
        - street
        - city
        - state
        - postalCode
        - country
      properties:
        street:
          type: string
          description: Street address
          example: 123 Main St
        city:
          type: string
          description: City
          example: San Francisco
        state:
          type: string
          description: State/Province/Region
          example: CA
        postalCode:
          type: string
          description: Postal/ZIP code
          example: "94105"
        country:
          type: string
          description: Country code (ISO 3166-1 alpha-2)
          example: US
    
    Domain:
      type: object
      required:
        - id
        - domainName
        - status
        - expiresAt
        - autoRenew
      properties:
        id:
          type: string
          description: Unique domain ID
          example: dom_12345
        domainName:
          type: string
          description: The registered domain name
          example: example.com
        status:
          type: string
          description: Domain status
          enum:
            - active
            - pending
            - transferring
            - expired
          example: active
        expiresAt:
          type: string
          format: date-time
          description: Domain expiry date
          example: "2024-03-16T00:00:00Z"
        autoRenew:
          type: boolean
          description: Whether auto-renewal is enabled
          example: true
        nameservers:
          type: array
          items:
            type: string
          description: List of nameservers assigned to the domain
          example:
            - ns1.oblien.com
            - ns2.oblien.com
  
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        API keys can be obtained from the [Oblien Dashboard](https://dashboard.oblien.com/api-keys).
        
        All requests should include the API key in the Authorization header:
        ```
        Authorization: Bearer YOUR_API_KEY