---
title: User Segmentation
description: Automatically segment users based on behavior patterns
---

import { ApiBlock } from '@/components/api-block-mdx'

# User Segmentation

Automatically segment your users based on behavior patterns, engagement levels, and traits. Use segments for targeted campaigns, A/B testing, and personalized experiences.

## Generate User Segments

Create user segments using machine learning clustering algorithms:

<ApiBlock
  method="POST"
  endpoint="/ml/segment-users"
  curl={`curl -X POST "https://api.norai.com/ml/segment-users" \\
  -H "Authorization: Bearer YOUR_API_KEY" \\
  -H "Content-Type: application/json" \\
  -d '{
    "project_id": "your-project-id",
    "algorithm": "kmeans",
    "num_segments": 5,
    "features": ["engagement_score", "purchase_frequency", "avg_session_duration"]
  }'`}
  nodejs={`const response = await fetch('https://api.norai.com/ml/segment-users', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    project_id: 'your-project-id',
    algorithm: 'kmeans',
    num_segments: 5,
    features: ['engagement_score', 'purchase_frequency', 'avg_session_duration']
  })
});

const segmentJob = await response.json();`}
  python={`import requests

response = requests.post(
    "https://api.norai.com/ml/segment-users",
    headers={
        "Authorization": "Bearer YOUR_API_KEY",
        "Content-Type": "application/json"
    },
    json={
        "project_id": "your-project-id",
        "algorithm": "kmeans",
        "num_segments": 5,
        "features": ["engagement_score", "purchase_frequency", "avg_session_duration"]
    }
)

segment_job = response.json()`}
/>

### Example Response

```json
{
  "job_id": "seg_abc123-def456",
  "status": "queued",
  "message": "Segmentation job queued. Check status at /ml/jobs/seg_abc123-def456"
}
```

## Segmentation Algorithms

Norai supports multiple segmentation algorithms:

### K-Means Clustering

Groups users into a specified number of segments based on behavioral similarity:

```json
{
  "algorithm": "kmeans",
  "num_segments": 5
}
```

### DBSCAN

Density-based clustering that automatically determines the number of segments:

```json
{
  "algorithm": "dbscan",
  "eps": 0.5,
  "min_samples": 10
}
```

### Hierarchical Clustering

Creates a hierarchy of segments:

```json
{
  "algorithm": "hierarchical",
  "num_segments": 5,
  "linkage": "ward"
}
```

## Get User's Segment

Retrieve the segment assignment for a specific user:

<ApiBlock
  method="GET"
  endpoint="/ml/users/:userId/segment"
  curl={`curl -X GET "https://api.norai.com/ml/users/user_123/segment?project_id=your-project-id" \\
  -H "Authorization: Bearer YOUR_API_KEY"`}
  nodejs={`const response = await fetch('https://api.norai.com/ml/users/user_123/segment?project_id=your-project-id', {
  method: 'GET',
  headers: {
    'Authorization': 'Bearer YOUR_API_KEY'
  }
});

const segmentData = await response.json();`}
/>

### Example Response

```json
{
  "user_id": "user_123",
  "segment_id": "high_value_customers",
  "segment_name": "High Value Customers",
  "characteristics": {
    "avg_purchase_value": 250.50,
    "purchase_frequency": "weekly",
    "engagement_score": 0.92
  },
  "assigned_at": "2025-12-03T10:30:00Z"
}
```

## List All Segments

Get all segments and their characteristics:

<ApiBlock
  method="GET"
  endpoint="/ml/segments"
  curl={`curl -X GET "https://api.norai.com/ml/segments?project_id=your-project-id" \\
  -H "Authorization: Bearer YOUR_API_KEY"`}
/>

### Example Response

```json
{
  "segments": [
    {
      "id": "high_value_customers",
      "name": "High Value Customers",
      "user_count": 1523,
      "characteristics": {
        "avg_purchase_value": 250.50,
        "purchase_frequency": "weekly",
        "engagement_score": 0.92
      }
    },
    {
      "id": "occasional_browsers",
      "name": "Occasional Browsers",
      "user_count": 3421,
      "characteristics": {
        "avg_purchase_value": 45.20,
        "purchase_frequency": "monthly",
        "engagement_score": 0.45
      }
    }
  ]
}
```

## Get Users in Segment

Retrieve all users in a specific segment:

<ApiBlock
  method="GET"
  endpoint="/ml/segments/:segmentId/users"
  curl={`curl -X GET "https://api.norai.com/ml/segments/high_value_customers/users?project_id=your-project-id&limit=100" \\
  -H "Authorization: Bearer YOUR_API_KEY"`}
/>

## Segment Features

Common features used for segmentation:

- `engagement_score` - Overall user engagement level
- `purchase_frequency` - How often user makes purchases
- `avg_purchase_value` - Average transaction value
- `session_duration` - Average session length
- `days_since_last_activity` - Recency metric
- `total_events` - Total number of tracked events
- `category_preferences` - Preferred product/content categories

## Custom Segments

Create custom segments based on specific criteria:

<ApiBlock
  method="POST"
  endpoint="/ml/segments/custom"
  curl={`curl -X POST "https://api.norai.com/ml/segments/custom" \\
  -H "Authorization: Bearer YOUR_API_KEY" \\
  -H "Content-Type: application/json" \\
  -d '{
    "project_id": "your-project-id",
    "name": "Premium Cart Abandoners",
    "criteria": {
      "has_cart_items": true,
      "days_since_last_purchase": {"gt": 30},
      "avg_cart_value": {"gt": 100}
    }
  }'`}
/>

## Use Cases

### Targeted Marketing

Send personalized campaigns to specific segments:

```javascript
// Get high-value customers
const highValueUsers = await fetch('/ml/segments/high_value_customers/users');

// Send targeted email campaign
await sendEmail(highValueUsers, 'vip_promotion_template');
```

### A/B Testing

Test features with specific user segments:

```javascript
// Get segment for user
const segment = await getUserSegment('user_123');

// Show different UI based on segment
if (segment.id === 'power_users') {
  showAdvancedFeatures();
} else {
  showSimplifiedUI();
}
```

### Personalized Recommendations

Generate segment-specific recommendations:

```javascript
const recommendations = await fetch('/ml/generate-recommendations', {
  body: JSON.stringify({
    user_id: 'user_123',
    segment: 'high_value_customers',
    limit: 10
  })
});
```

## Best Practices

1. **Regular updates**: Re-run segmentation periodically to reflect changing behavior
2. **Meaningful features**: Choose features that align with your business goals
3. **Optimal number**: Use 3-7 segments for actionable insights
4. **Validate segments**: Review segment characteristics to ensure they make business sense
5. **Monitor changes**: Track how users move between segments over time

